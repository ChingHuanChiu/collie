[pytest]
# Test discovery - separate unit and integration tests
testpaths = tests/unit_tests tests/integration_tests
python_files = test_*.py *_test.py
python_classes = Test* *Tests
python_functions = test_*

# Output formatting
addopts = 
    -v
    --tb=short
    --strict-markers
    --color=yes
    --durations=10
    --maxfail=5

# Markers for test organization
markers =
    # Test types
    unit: Unit tests - fast, isolated tests for individual components
    integration: Integration tests - tests that verify multiple components work together
    component: Component-specific tests
    slow: Tests that take more than a few seconds to execute
    
    # Test categories
    smoke: Quick smoke tests for basic functionality
    regression: Regression tests for bug fixes
    models: Tests for data models and schemas
    events: Tests for event system
    orchestrator: Tests for pipeline orchestration
    mlflow: Tests requiring MLflow functionality
    
    # Component markers
    transformer: Tests for data transformation component
    trainer: Tests for model training component
    tuner: Tests for hyperparameter tuning component
    evaluator: Tests for model evaluation component
    pusher: Tests for model deployment component
    
    # Performance markers
    memory: Tests that check memory usage
    performance: Performance benchmarking tests
    
    # Environment markers
    requires_gpu: Tests that require GPU
    requires_internet: Tests that need internet connection
    requires_mlflow_server: Tests that need MLflow tracking server

# Filtering warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:pandas.*
    ignore::FutureWarning:pandas.*

# Test collection - use norecursedirs instead of collect_ignore_glob
norecursedirs = [
    "setup.py",
    "docs",
    "build", 
    "dist",
    ".tox",
    "htmlcov",
    ".pytest_cache",
    "__pycache__",
    "*.egg-info"]

# Minimum version requirements
minversion = 6.0

# Console output
console_output_style = progress

# Log configuration
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Timeout for tests (requires pytest-timeout plugin)
# timeout = 300
# timeout_method = thread